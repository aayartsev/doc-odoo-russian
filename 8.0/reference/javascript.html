<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Javascript &mdash; odoo 8.0 перевод на русский язык документации odoo 8.0</title>

    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/patchqueue.css" type="text/css" />

    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <link rel="top" title="перевод на русский язык документации odoo 8.0" href="../index.html" />
    <link rel="up" title="Reference" href="../reference.html" />
    <link rel="next" title="Translating Modules" href="./translations.html" />
    <link rel="prev" title="QWeb" href="./qweb.html" />
</head>

<body role="document">
    <header class="">
        <figure class="card top">
            <span class="card-img" style="background-image: url('../_static/banners/javascript.jpg');"></span>
        </figure>
    </header>
    <nav id="main_navbar" class="navbar ">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-main">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <nav class="nav navbar-nav navbar-left">
                    <li id="main-back">
                        <a href="../index.html" class="mdi-navigation-arrow-back"></a>
                    </li>
                    <li>
                        <h1 id="main_title">Javascript</h1>
                    </li>
                </nav>
            </div>

            <nav class="collapse navbar-collapse navbar-main navbar-right" role="navigation">

                <ul class="navbar-nav navbar-right nav">
                    <li class="versions">
                        <a class="dropdown-toggle" data-toggle="dropdown">
                8.0 <span class="caret"></span>
              </a>
                        <ul class="dropdown-menu" role="menu">

                            <li><a href="https://www.odoo.com/documentation/9.0/reference/javascript.html">9.0</a></li>

                        </ul>
                    </li>
                </ul>

                <ul class="current navbar-nav navbar-right nav">
                    <li class="toctree-l1 dropdown"><a data-toggle="dropdown" href="../tutorials.html" class="dropdown-toggle internal reference">Tutorials</a>
                        <ul class="dropdown-menu">
                            <li class="toctree-l2"><a href="../howtos/themes.html" class="internal reference">Theme Tutorial</a></li>
                            <li class="toctree-l2"><a href="../howtos/website.html" class="internal reference">Building a Website</a></li>
                            <li class="toctree-l2"><a href="../howtos/backend.html" class="internal reference">Building a Module</a></li>
                            <li class="toctree-l2"><a href="../howtos/web.html" class="internal reference">Building Interface Extensions</a></li>
                        </ul>
                    </li>
                    <li class="toctree-l1"><a href="../api_integration.html" class="internal reference">Web Service API</a>
                        <ul></ul>
                    </li>
                    <li class="toctree-l1 dropdown"><a data-toggle="dropdown" href="../setup.html" class="dropdown-toggle internal reference">Setting Up</a>
                        <ul class="dropdown-menu">
                            <li class="toctree-l2"><a href="../setup/install.html" class="internal reference">Installing Odoo</a></li>
                            <li class="toctree-l2"><a href="../setup/deploy.html" class="internal reference">Deploying Odoo</a></li>
                        </ul>
                    </li>
                    <li class="toctree-l1 current dropdown"><a data-toggle="dropdown" href="../reference.html" class="dropdown-toggle internal reference">Reference</a>
                        <ul class="current dropdown-menu">
                            <li class="toctree-l2"><a href="../reference/orm.html" class="internal reference">ORM API</a></li>
                            <li class="toctree-l2"><a href="../reference/data.html" class="internal reference">Data Files</a></li>
                            <li class="toctree-l2"><a href="../reference/actions.html" class="internal reference">Actions</a></li>
                            <li class="toctree-l2"><a href="../reference/views.html" class="internal reference">Views</a></li>
                            <li class="toctree-l2"><a href="../reference/module.html" class="internal reference">Modules</a></li>
                            <li class="toctree-l2"><a href="../reference/cmdline.html" class="internal reference">Command-line interface: odoo.py</a></li>
                            <li class="toctree-l2"><a href="../reference/security.html" class="internal reference">Security in Odoo</a></li>
                            <li class="toctree-l2"><a href="../reference/testing.html" class="internal reference">Testing Modules</a></li>
                            <li class="toctree-l2"><a href="../reference/http.html" class="internal reference">Web Controllers</a></li>
                            <li class="toctree-l2"><a href="../reference/qweb.html" class="internal reference">QWeb</a></li>
                            <li class="current toctree-l2"><a href="" class="current internal reference">Javascript</a></li>
                            <li class="toctree-l2"><a href="../reference/translations.html" class="internal reference">Translating Modules</a></li>
                            <li class="toctree-l2"><a href="../reference/reports.html" class="internal reference">QWeb Reports</a></li>
                            <li class="toctree-l2"><a href="../reference/workflows.html" class="internal reference">Workflows</a></li>
                            <li class="toctree-l2"><a href="../reference/guidelines.html" class="internal reference">Odoo Guidelines</a></li>
                            <li class="toctree-l2"><a href="../reference/upgrade_api.html" class="internal reference">Upgrade API</a></li>
                        </ul>
                    </li>
                    <li class="toctree-l1 dropdown"><a data-toggle="dropdown" href="../business.html" class="dropdown-toggle internal reference">Business Mementoes</a>
                        <ul class="dropdown-menu">
                            <li class="toctree-l2"><a href="https://odoo.com/documentation/functional/accounting.html" class="external reference">Accounting Memento (US GAAP)</a></li>
                            <li class="toctree-l2"><a href="https://odoo.com/documentation/functional/double-entry.html" class="external reference">Double-Entry Inventory</a></li>
                            <li class="toctree-l2"><a href="https://odoo.com/documentation/functional/valuation.html" class="external reference">Inventory Valuations</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </nav>


    <main class="container ">

        <div class="row">

            <aside>
                <div class="navbar-aside text-center">
                    <div class="logo_box">
                        <span class="logo"></span> Documentation
                    </div>
                    <ul class="list-group text-left nav">
                        <li class="list-group-item"><a href="#widgets" class="ripple internal reference">Widgets</a>
                            <ul>
                                <li class="list-group-item"><a href="#dom-root" class="ripple internal reference">DOM Root</a>
                                    <ul>
                                        <li class="list-group-item"><a href="#using-a-widget" class="ripple internal reference">Using a widget</a></li>
                                        <li class="list-group-item"><a href="#accessing-dom-content" class="ripple internal reference">Accessing DOM content</a></li>
                                        <li class="list-group-item"><a href="#resetting-the-dom-root" class="ripple internal reference">Resetting the DOM root</a></li>
                                    </ul>
                                </li>
                                <li class="list-group-item"><a href="#dom-events-handling" class="ripple internal reference">DOM events handling</a></li>
                                <li class="list-group-item"><a href="#subclassing-widget" class="ripple internal reference">Subclassing Widget</a></li>
                                <li class="list-group-item"><a href="#development-guidelines" class="ripple internal reference">Development Guidelines</a></li>
                            </ul>
                        </li>
                        <li class="list-group-item"><a href="#rpc" class="ripple internal reference">RPC</a>
                            <ul>
                                <li class="list-group-item"><a href="#high-level-api-calling-into-odoo-models" class="ripple internal reference">High-level API: calling into Odoo models</a>
                                    <ul>
                                        <li class="list-group-item"><a href="#aggregation-grouping" class="ripple internal reference">Aggregation (grouping)</a></li>
                                    </ul>
                                </li>
                                <li class="list-group-item"><a href="#low-level-api-rpc-calls-to-python-side" class="ripple internal reference">Low-level API: RPC calls to Python side</a></li>
                            </ul>
                        </li>
                        <li class="list-group-item"><a href="#web-client" class="ripple internal reference">Web Client</a></li>
                        <li class="list-group-item"><a href="#testing-in-odoo-web-client" class="ripple internal reference">Testing in Odoo Web Client</a>
                            <ul>
                                <li class="list-group-item"><a href="#javascript-unit-testing" class="ripple internal reference">Javascript Unit Testing</a></li>
                                <li class="list-group-item"><a href="#writing-a-test-case" class="ripple internal reference">Writing a test case</a></li>
                                <li class="list-group-item"><a href="#assertions" class="ripple internal reference">Assertions</a></li>
                                <li class="list-group-item"><a href="#getting-an-odoo-instance" class="ripple internal reference">Getting an Odoo instance</a></li>
                                <li class="list-group-item"><a href="#dom-scratchpad" class="ripple internal reference">DOM Scratchpad</a></li>
                                <li class="list-group-item"><a href="#loading-templates" class="ripple internal reference">Loading templates</a></li>
                                <li class="list-group-item"><a href="#asynchronous-cases" class="ripple internal reference">Asynchronous cases</a></li>
                                <li class="list-group-item"><a href="#id3" class="ripple internal reference">RPC</a></li>
                                <li class="list-group-item"><a href="#testing-api" class="ripple internal reference">Testing API</a></li>
                                <li class="list-group-item"><a href="#running-through-python" class="ripple internal reference">Running through Python</a></li>
                            </ul>
                        </li>
                    </ul>

                    <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/8.0/doc/reference/javascript.rst" class="gith-link">
              Edit on GitHub
          </a></p>

                </div>
            </aside>

            <article class="doc-body ">


                <section id="javascript"></section>
                <section id="widgets">
                    <h2>Widgets</h2>
                    <section class="code-class">
                        <h6 id="openerp.Widget"><code><em >class </em>openerp.Widget()</code></h6>
                        <p>The base class for all visual components. It corresponds to an MVC view, and provides a number of service to simplify handling of a section of a page:</p>
                        <ul>
                            <li>Handles parent/child relationships between widgets</li>
                            <li>Provides extensive lifecycle management with safety features (e.g. automatically destroying children widgets during the destruction of a parent)
                            </li>
                            <li>Automatic rendering with <a href="qweb.html#reference-qweb" class="internal alert-link reference"><span >qweb</span></a></li>
                            <li>Backbone-compatible shortcuts</li>
                        </ul>
                    </section>
                </section>
                <section id="dom-root">
                    <h3>DOM Root</h3>
                    <p>A <a href="#openerp.Widget" class="internal reference" title="openerp.Widget"><code class="js-class xref js">Widget()</code></a> is responsible for a section of the page materialized by the DOM root of the widget.</p>
                    <p>A widget's DOM root is available via two attributes:</p>
                    <section class="code-attribute">
                        <h6 id="openerp.Widget.el"><code>openerp.Widget.el</code></h6>
                        <p>raw DOM element set as root to the widget</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="openerp.Widget._S_el"><code>openerp.Widget.$el</code></h6>
                        <p>jQuery wrapper around <a href="#openerp.Widget.el" class="internal alert-link reference" title="openerp.Widget.el"><code class="js-attr xref js">el</code></a></p>
                    </section>
                    <p>There are two main ways to define and generate this DOM root:</p>
                    <section class="code-attribute">
                        <h6 id="openerp.Widget.template"><code>openerp.Widget.template</code></h6>
                        <p>Should be set to the name of a <a href="qweb.html#reference-qweb" class="internal alert-link reference"><span >QWeb template</span></a>. If set, the template will be rendered after the widget has been initialized but before it
                            has been started. The root element generated by the template will be set as the DOM root of the widget.</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="openerp.Widget.tagName"><code>openerp.Widget.tagName</code></h6>
                        <p>Used if the widget has no template defined. Defaults to <code>div</code>, will be used as the tag name to create the DOM element to set as the widget's DOM root. It is possible to further customize this generated DOM root with
                            the following attributes:</p>
                        <section class="code-attribute">
                            <h6 id="openerp.Widget.id"><code>openerp.Widget.id</code></h6>
                            <p>Used to generate an <code>id</code> attribute on the generated DOM root.
                            </p>
                        </section>
                        <section class="code-attribute">
                            <h6 id="openerp.Widget.className"><code>openerp.Widget.className</code></h6>
                            <p>Used to generate a <code>class</code> attribute on the generated DOM root.</p>
                        </section>
                        <section class="code-attribute">
                            <h6 id="openerp.Widget.attributes"><code>openerp.Widget.attributes</code></h6>
                            <p>Mapping (object literal) of attribute names to attribute values. Each of these k:v pairs will be set as a DOM attribute on the generated DOM root.</p>
                        </section>
                        <p>None of these is used in case a template is specified on the widget.</p>
                    </section>
                    <p>The DOM root can also be defined programmatically by overridding</p>
                    <section class="code-function">
                        <h6 id="openerp.Widget.renderElement"><code>openerp.Widget.renderElement()</code></h6>
                        <p>Renders the widget's DOM root and sets it. The default implementation will render a set template or generate an element as described above, and will call
                            <a href="#openerp.Widget.setElement" class="internal alert-link reference" title="openerp.Widget.setElement"><code class="js-func xref js">setElement()</code></a> on the result.</p>
                        <p>Any override to <a href="#openerp.Widget.renderElement" class="internal alert-link reference" title="openerp.Widget.renderElement"><code class="js-func xref js">renderElement()</code></a> which does not call its <code>_super</code>                            <strong>must</strong> call
                            <a href="#openerp.Widget.setElement" class="internal alert-link reference" title="openerp.Widget.setElement"><code class="js-func xref js">setElement()</code></a> with whatever it generated or the widget's behavior is undefined.</p>
                        <div
                            role="alert" class="alert-info alert">
                            <p class="alert-title">Note</p>
                            <p>The default <a href="#openerp.Widget.renderElement" class="internal alert-link reference" title="openerp.Widget.renderElement"><code class="js-func xref js">renderElement()</code></a> can be called repeatedly, it will <em>replace</em>                                the previous DOM root (using <code>replaceWith</code>). However, this requires that the widget correctly sets and unsets its events (and children widgets). Generally, <a href="#openerp.Widget.renderElement" class="internal alert-link reference"
                                    title="openerp.Widget.renderElement"><code class="js-func xref js">renderElement()</code></a> should not be called repeatedly unless the widget advertizes this feature.</p>
        </div>
        </section>
        </section>
        <section id="using-a-widget">
            <h4>Using a widget</h4>
            <p>A widget's lifecycle has 3 main phases:</p>
            <ul>
                <li>
                    <p>creation and initialization of the widget instance</p>
                    <section class="code-function">
                        <h6 id="openerp.Widget.init"><code>openerp.Widget.init(<em>parent</em>)</code></h6>
                        <p>initialization method of widgets, synchronous, can be overridden to take more parameters from the widget's creator/parent</p>
                        <div class="code-fields">
                            <div class="code-field">
                                <div class="code-field-name">Arguments</div>
                                <div class="code-field-body">
                                    <ul>
                                        <li><strong>parent</strong> (<a href="#openerp.Widget" class="internal alert-link reference" title="openerp.Widget"><code class="js-class xref js">Widget()</code></a>) -- the new widget's parent, used to handle automatic
                                            destruction and event propagation. Can be <code>null</code> for the widget to have no parent.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>
                </li>
                <li>
                    <p>DOM injection and startup, this is done by calling one of:</p>
                    <section class="code-function">
                        <h6 id="openerp.Widget.appendTo"><code>openerp.Widget.appendTo(<em>element</em>)</code></h6>
                        <p>Renders the widget and inserts it as the last child of the target, uses
                            <a href="http://api.jquery.com/appendTo/" class="external reference alert-link">.appendTo()</a></p>
                    </section>
                    <section class="code-function">
                        <h6 id="openerp.Widget.prependTo"><code>openerp.Widget.prependTo(<em>element</em>)</code></h6>
                        <p>Renders the widget and inserts it as the first child of the target, uses
                            <a href="http://api.jquery.com/prependTo/" class="external reference alert-link">.prependTo()</a></p>
                    </section>
                    <section class="code-function">
                        <h6 id="openerp.Widget.insertAfter"><code>openerp.Widget.insertAfter(<em>element</em>)</code></h6>
                        <p>Renders the widget and inserts it as the preceding sibling of the target, uses <a href="http://api.jquery.com/insertAfter/" class="external reference alert-link">.insertAfter()</a></p>
                    </section>
                    <section class="code-function">
                        <h6 id="openerp.Widget.insertBefore"><code>openerp.Widget.insertBefore(<em>element</em>)</code></h6>
                        <p>Renders the widget and inserts it as the following sibling of the target, uses <a href="http://api.jquery.com/insertBefore/" class="external reference alert-link">.insertBefore()</a></p>
                    </section>
                    <p>All of these methods accept whatever the corresponding jQuery method accepts (CSS selectors, DOM nodes or jQuery objects). They all return a <a href="http://api.jquery.com/category/deferred-object/" class="external reference">deferred</a>                        and are charged with three tasks:</p>
                    <ul>
                        <li>rendering the widget's root element via
                            <a href="#openerp.Widget.renderElement" class="internal reference" title="openerp.Widget.renderElement"><code class="js-func xref js">renderElement()</code></a></li>
                        <li>inserting the widget's root element in the DOM using whichever jQuery method they match</li>
                        <li>
                            <p>starting the widget, and returning the result of starting it</p>
                            <section class="code-function">
                                <h6 id="openerp.Widget.start"><code>openerp.Widget.start()</code></h6>
                                <p>asynchronous startup of the widget once it's been injected in the DOM, generally used to perform asynchronous RPC calls to fetch whatever remote data is necessary for the widget to do its work.</p>
                                <p>Must return a <a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a> to indicate when its work is done.</p>
                                <p>A widget is <em>not guaranteed</em> to work correctly until its
                                    <a href="#openerp.Widget.start" class="internal alert-link reference" title="openerp.Widget.start"><code class="js-func xref js">start()</code></a> method has finished executing. The widget's parent/creator must wait
                                    for a widget to be fully started before interacting with it</p>
                                <div class="code-fields">
                                    <div class="code-field">
                                        <div class="code-field-name">Returns</div>
                                        <div class="code-field-body"><a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a> object</div>
                                    </div>
                                </div>
                            </section>
                        </li>
                    </ul>
                </li>
                <li>
                    <p>widget destruction and cleanup</p>
                    <section class="code-function">
                        <h6 id="openerp.Widget.destroy"><code>openerp.Widget.destroy()</code></h6>
                        <p>destroys the widget's children, unbinds its events and removes its root from the DOM. Automatically called when the widget's parent is destroyed, must be called explicitly if the widget has no parents or if it is removed but its
                            parent remains.</p>
                        <p>A widget being destroyed is automatically unlinked from its parent.</p>
                    </section>
                </li>
            </ul>
            <p>Related to widget destruction is an important utility method:</p>
            <section class="code-function">
                <h6 id="openerp.Widget.alive"><code>openerp.Widget.alive(<em>deferred</em>[, <em>reject=false</em>])</code></h6>
                <p>A significant issue with RPC and destruction is that an RPC call may take a long time to execute and return while a widget is being destroyed or after it has been destroyed, trying to execute its operations on a widget in a broken/invalid
                    state.</p>
                <p>This is a frequent source of errors or strange behaviors.</p>
                <p><a href="#openerp.Widget.alive" class="internal alert-link reference" title="openerp.Widget.alive"><code class="js-func xref js">alive()</code></a> can be used to wrap an RPC call, ensuring that whatever operations should be executed when
                    the call ends are only executed if the widget is still alive:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">alive</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">query</span><span class="p">().</span><span class="nx">all</span><span class="p">()).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">records</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// would break if executed after the widget is destroyed, wrapping</span>
    <span class="c1">// rpc in alive() prevents execution</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">records</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">record</span><span class="p">));</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
                </div>
                <div class="code-fields">
                    <div class="code-field">
                        <div class="code-field-name">Arguments</div>
                        <div class="code-field-body">
                            <ul>
                                <li><strong>deferred</strong> -- a <a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a> object to wrap</li>
                                <li><strong>reject</strong> -- by default, if the RPC call returns after the widget has been destroyed the returned <a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a>                                    is left in limbo (neither resolved nor rejected). If <code>reject</code> is set to
                                    <code>true</code>, the <a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a> will be rejected instead.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-field">
                        <div class="code-field-name">Returns</div>
                        <div class="code-field-body"><a href="http://api.jquery.com/category/deferred-object/" class="external reference alert-link">deferred</a> object</div>
                    </div>
                </div>
            </section>
            <section class="code-function">
                <h6 id="openerp.Widget.isDestroyed"><code>openerp.Widget.isDestroyed()</code></h6>
                <div class="code-fields">
                    <div class="code-field">
                        <div class="code-field-name">Returns</div>
                        <div class="code-field-body"><code>true</code> if the widget is being or has been destroyed, <code>false</code> otherwise
                        </div>
                    </div>
                </div>
            </section>
        </section>
        <section id="accessing-dom-content">
            <h4>Accessing DOM content</h4>
            <dl><dt>Because a widget is only responsible for the content below its DOM root, there</dt>
                <dd>is a shortcut for selecting sub-sections of a widget's DOM:</dd>
            </dl>
            <section class="code-function">
                <h6 id="openerp.Widget._S_"><code>openerp.Widget.$(<em>selector</em>)</code></h6>
                <p>Applies the CSS selector specified as parameter to the widget's DOM root:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</pre></div>
                </div>
                <p>is functionally identical to:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</pre></div>
                </div>
                <div class="code-fields">
                    <div class="code-field">
                        <div class="code-field-name">Arguments</div>
                        <div class="code-field-body">
                            <ul>
                                <li><strong>selector</strong> (<em>String</em>) -- CSS selector</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-field">
                        <div class="code-field-name">Returns</div>
                        <div class="code-field-body">jQuery object</div>
                    </div>
                </div>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>this helper method is similar to <code>Backbone.View.$</code></p>
                </div>
            </section>
        </section>
        <section id="resetting-the-dom-root">
            <h4>Resetting the DOM root</h4>
            <section class="code-function">
                <h6 id="openerp.Widget.setElement"><code>openerp.Widget.setElement(<em>element</em>)</code></h6>
                <p>Re-sets the widget's DOM root to the provided element, also handles re-setting the various aliases of the DOM root as well as unsetting and re-setting delegated events.</p>
                <div class="code-fields">
                    <div class="code-field">
                        <div class="code-field-name">Arguments</div>
                        <div class="code-field-body">
                            <ul>
                                <li><strong>element</strong> (<em>Element</em>) -- a DOM element or jQuery object to set as the widget's DOM root</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>should be mostly compatible with <a href="http://backbonejs.org/#View-setElement" class="external reference alert-link">Backbone's
setElement</a></p>
                </div>
            </section>
        </section>
        <section id="dom-events-handling">
            <h3>DOM events handling</h3>
            <p>A widget will generally need to respond to user action within its section of the page. This entails binding events to DOM elements.</p>
            <p>To this end, <a href="#openerp.Widget" class="internal reference" title="openerp.Widget"><code class="js-class xref js">Widget()</code></a> provides a shortcut:</p>
            <section class="code-attribute">
                <h6 id="openerp.Widget.events"><code>openerp.Widget.events</code></h6>
                <p>Events are a mapping of an event selector (an event name and an optional CSS selector separated by a space) to a callback. The callback can be the name of a widget's method or a function object. In either case, the
                    <code>this</code> will be set to the widget:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;click p.oe_some_class a&#39;</span><span class="o">:</span> <span class="s1">&#39;some_method&#39;</span><span class="p">,</span>
    <span class="s1">&#39;change input&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">},</span>
</pre></div>
                </div>
                <p>The selector is used for jQuery's <a href="http://api.jquery.com/delegate/" class="external reference alert-link">event delegation</a>, the callback will only be triggered for descendants of the DOM root matching the selector<a href="#eventsdelegation"
                        class="footnote-ref" id="id1">1</a>. If the selector is left out (only an event name is specified), the event will be set directly on the widget's DOM root.</p>
            </section>
            <section class="code-function">
                <h6 id="openerp.Widget.delegateEvents"><code>openerp.Widget.delegateEvents()</code></h6>
                <p>This method is in charge of binding <a href="#openerp.Widget.events" class="internal alert-link reference" title="openerp.Widget.events"><code class="js-attr xref js">events</code></a> to the DOM. It is automatically called after setting
                    the widget's DOM root.</p>
                <p>It can be overridden to set up more complex events than the
                    <a href="#openerp.Widget.events" class="internal alert-link reference" title="openerp.Widget.events"><code class="js-attr xref js">events</code></a> map allows, but the parent should always be called (or <a href="#openerp.Widget.events"
                        class="internal alert-link reference" title="openerp.Widget.events"><code class="js-attr xref js">events</code></a> won't be handled correctly).</p>
            </section>
            <section class="code-function">
                <h6 id="openerp.Widget.undelegateEvents"><code>openerp.Widget.undelegateEvents()</code></h6>
                <p>This method is in charge of unbinding <a href="#openerp.Widget.events" class="internal alert-link reference" title="openerp.Widget.events"><code class="js-attr xref js">events</code></a> from the DOM root when the widget is destroyed or
                    the DOM root is reset, in order to avoid leaving &quot;phantom&quot; events.</p>
                <p>It should be overridden to un-set any event set in an override of
                    <a href="#openerp.Widget.delegateEvents" class="internal alert-link reference" title="openerp.Widget.delegateEvents"><code class="js-func xref js">delegateEvents()</code></a>.</p>
            </section>
            <div role="alert" class="alert-info alert">
                <p class="alert-title">Note</p>
                <p>this behavior should be compatible with <a href="http://backbonejs.org/#View-delegateEvents" class="external reference alert-link">Backbone's
delegateEvents</a>, apart from not accepting any argument.</p>
            </div>
        </section>
        <section id="subclassing-widget">
            <h3>Subclassing Widget</h3>
            <p><a href="#openerp.Widget" class="internal reference" title="openerp.Widget"><code class="js-class xref js">Widget()</code></a> is subclassed in the standard manner (via the
                <code class="js-func xref js">extend()</code> method), and provides a number of abstract properties and concrete methods (which you may or may not want to override). Creating a subclass looks like this:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">openerp</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="c1">// QWeb template to use when rendering the object</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;MyQWebTemplate&quot;</span><span class="p">,</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// events binding example</span>
        <span class="s1">&#39;click .my-button&#39;</span><span class="o">:</span> <span class="s1">&#39;handle_click&#39;</span><span class="p">,</span>
    <span class="p">},</span>

    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="c1">// insert code to execute before rendering, for object</span>
        <span class="c1">// initialization</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">sup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="c1">// post-rendering initialization code, at this point</span>

        <span class="c1">// allows multiplexing deferred objects</span>
        <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span>
            <span class="c1">// propagate asynchronous signal from parent class</span>
            <span class="nx">sup</span><span class="p">,</span>
            <span class="c1">// return own&#39;s asynchronous signal</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rpc</span><span class="p">(</span><span class="cm">/* … */</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
            </div>
            <p>The new class can then be used in the following manner:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="c1">// Create the instance</span>
<span class="kd">var</span> <span class="nx">my_widget</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="c1">// Render and insert into DOM</span>
<span class="nx">my_widget</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;.some-div&quot;</span><span class="p">);</span>
</pre></div>
            </div>
            <p>After these two lines have executed (and any promise returned by
                <a href="#openerp.Widget.appendTo" class="internal reference" title="openerp.Widget.appendTo"><code class="js-func xref js">appendTo()</code></a> has been resolved if needed), the widget is ready to be used.</p>
            <div role="alert" class="alert-info alert">
                <p class="alert-title">Note</p>
                <p>the insertion methods will start the widget themselves, and will return the result of <a href="#openerp.Widget.start" class="internal alert-link reference" title="openerp.Widget.start"><code class="js-func xref js">start()</code></a>.</p>
                <p>If for some reason you do not want to call these methods, you will have to first call <code class="js-func xref js">render()</code> on the widget, then insert it into your DOM and start it.</p>
            </div>
            <p>If the widget is not needed anymore (because it's transient), simply terminate it:
            </p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="nx">my_widget</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
            </div>
            <p>will unbind all DOM events, remove the widget's content from the DOM and destroy all widget data.</p>
        </section>
        <section id="development-guidelines">
            <h3>Development Guidelines</h3>
            <ul>
                <li>
                    <p>Identifiers (<code>id</code> attribute) should be avoided. In generic applications and modules, <code>id</code> limits the re-usability of components and tends to make code more brittle. Most of the time, they can be replaced with
                        nothing, classes or keeping a reference to a DOM node or jQuery element.</p>
                    <p>If an <code>id</code> is absolutely necessary (because a third-party library requires one), the id should be partially generated using <code>_.uniqueId()</code> e.g.:</p>
                    <div class="highlight-javascript">
                        <div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniqueId</span><span class="p">(</span><span class="s1">&#39;my-widget-&#39;</span><span class="p">)</span>
</pre></div>
                    </div>
                </li>
                <li>Avoid predictable/common CSS class names. Class names such as &quot;content&quot; or &quot;navigation&quot; might match the desired meaning/semantics, but it is likely an other developer will have the same need, creating a naming conflict
                    and unintended behavior. Generic class names should be prefixed with e.g. the name of the component they belong to (creating &quot;informal&quot; namespaces, much as in C or Objective-C).</li>
                <li>Global selectors should be avoided. Because a component may be used several times in a single page (an example in Odoo is dashboards), queries should be restricted to a given component's scope. Unfiltered selections such as
                    <code>$(selector)</code> or <code>document.querySelectorAll(selector)</code> will generally lead to unintended or incorrect behavior. Odoo Web's
                    <code class="js-class xref js">Widget()</code> has an attribute providing its DOM root (
                    <code class="js-attr xref js">$el</code>), and a shortcut to select nodes directly (
                    <code class="js-func xref js">$()</code>).</li>
                <li>More generally, never assume your components own or controls anything beyond its own personal <code class="js-attr xref js">$el</code></li>
                <li>html templating/rendering should use QWeb unless absolutely trivial.</li>
                <li>All interactive components (components displaying information to the screen or intercepting DOM events) must inherit from <code class="js-class xref js">Widget()</code> and correctly implement and use its API and life cycle.</li>
            </ul>
        </section>
        <section id="rpc">
            <h2>RPC</h2>
            <p>To display and interact with data, calls to the Odoo server are necessary. This is performed using <abbr>RPC &lt;Remote Procedure Call&gt;</abbr>.</p>
            <p>Odoo Web provides two primary APIs to handle this: a low-level JSON-RPC based API communicating with the Python section of Odoo Web (and of your module, if you have a Python part) and a high-level API above that allowing your code to talk
                directly to high-level Odoo models.</p>
            <p>All networking APIs are <a href="async.html#reference-async" class="internal reference"><span >asynchronous</span></a>. As a result, all of them will return <a href="http://api.jquery.com/category/deferred-object/" class="external reference">Deferred</a>                objects (whether they resolve those with values or not). Understanding how those work before before moving on is probably necessary.</p>
        </section>
        <section id="high-level-api-calling-into-odoo-models">
            <h3>High-level API: calling into Odoo models</h3>
            <p>Access to Odoo object methods (made available through XML-RPC from the server) is done via <a href="#openerp.Model" class="internal reference" title="openerp.Model"><code class="js-class xref js">openerp.Model()</code></a>. It maps onto the
                Odoo server objects via two primary methods, <a href="#openerp.Model.call" class="internal reference" title="openerp.Model.call"><code class="js-func xref js">call()</code></a> and
                <a href="#openerp.Model.query" class="internal reference" title="openerp.Model.query"><code class="js-func xref js">query()</code></a>.</p>
            <p><a href="#openerp.Model.call" class="internal reference" title="openerp.Model.call"><code class="js-func xref js">call()</code></a> is a direct mapping to the corresponding method of the Odoo server object. Its usage is similar to that of
                the Odoo Model API, with three differences:</p>
            <ul>
                <li>The interface is <a href="async.html#reference-async" class="internal reference"><span >asynchronous</span></a>, so instead of returning results directly RPC method calls will return
                    <a href="http://api.jquery.com/category/deferred-object/" class="external reference">Deferred</a> instances, which will themselves resolve to the result of the matching RPC call.</li>
                <li>Because ECMAScript 3/Javascript 1.5 doesnt feature any equivalent to
                    <code>__getattr__</code> or <code>method_missing</code>, there needs to be an explicit method to dispatch RPC methods.</li>
                <li>
                    <p>No notion of pooler, the model proxy is instantiated where needed, not fetched from an other (somewhat global) object:</p>
                    <div class="highlight-javascript">
                        <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Users</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">openerp</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">);</span>

<span class="nx">Users</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;change_password&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;oldpassword&#39;</span><span class="p">,</span> <span class="s1">&#39;newpassword&#39;</span><span class="p">],</span>
                  <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="nx">some_context</span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something with change_password result</span>
<span class="p">});</span>
</pre></div>
                    </div>
                </li>
            </ul>
            <p><a href="#openerp.Model.query" class="internal reference" title="openerp.Model.query"><code class="js-func xref js">query()</code></a> is a shortcut for a builder-style interface to searches (<code>search</code> + <code>read</code> in Odoo
                RPC terms). It returns a <a href="#openerp.web.Query" class="internal reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> object which is immutable but allows building new <a href="#openerp.web.Query"
                    class="internal reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> instances from the first one, adding new properties or modifiying the parent object's:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="nx">Users</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">])</span>
     <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;company_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]])</span>
     <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
     <span class="p">.</span><span class="nx">all</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do work with users records</span>
<span class="p">});</span>
</pre></div>
            </div>
            <p>The query is only actually performed when calling one of the query serialization methods, <a href="#openerp.web.Query.all" class="internal reference" title="openerp.web.Query.all"><code class="js-func xref js">all()</code></a> and
                <a href="#openerp.web.Query.first" class="internal reference" title="openerp.web.Query.first"><code class="js-func xref js">first()</code></a>. These methods will perform a new RPC call every time they are called.</p>
            <p>For that reason, it's actually possible to keep &quot;intermediate&quot; queries around and use them differently/add new specifications on them.</p>
            <section class="code-class">
                <h6 id="openerp.Model"><code><em >class </em>openerp.Model(<em>name</em>)</code></h6>
                <section class="code-attribute">
                    <h6 id="openerp.Model.name"><code>openerp.Model.name</code></h6>
                    <p>name of the OpenERP model this object is bound to</p>
                </section>
                <section class="code-function">
                    <h6 id="openerp.Model.call"><code>openerp.Model.call(<em>method[, args][, kwargs]</em>)</code></h6>
                    <p>Calls the <code>method</code> method of the current model, with the provided positional and keyword arguments.</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>method</strong> (<em>String</em>) -- method to call over rpc on the
                                        <a href="#openerp.Model.name" class="internal alert-link reference" title="openerp.Model.name"><code class="js-attr xref js">name</code></a></li>
                                    <li><strong>args</strong> (<em>Array&lt;&gt;</em>) -- positional arguments to pass to the method, optional</li>
                                    <li><strong>kwargs</strong> (<em>Object&lt;&gt;</em>) -- keyword arguments to pass to the method, optional</li>
                                </ul>
                            </div>
                        </div>
                        <div class="code-field">
                            <div class="code-field-name">Return type</div>
                            <div class="code-field-body">Deferred&lt;&gt;</div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="openerp.Model.query"><code>openerp.Model.query(<em>fields</em>)</code></h6>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>fields</strong> (<em>Array&lt;String&gt;</em>) -- list of fields to fetch during the search</li>
                                </ul>
                            </div>
                        </div>
                        <div class="code-field">
                            <div class="code-field-name">Returns</div>
                            <div class="code-field-body">a <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> object representing the search to perform</div>
                        </div>
                    </div>
                </section>
            </section>
            <section class="code-class">
                <h6 id="openerp.web.Query"><code><em >class </em>openerp.web.Query(<em>fields</em>)</code></h6>
                <p>The first set of methods is the &quot;fetching&quot; methods. They perform RPC queries using the internal data of the object they're called on.
                </p>
                <section class="code-function">
                    <h6 id="openerp.web.Query.all"><code>openerp.web.Query.all()</code></h6>
                    <p>Fetches the result of the current <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> object's search.
                    </p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Return type</div>
                            <div class="code-field-body">Deferred&lt;Array&lt;&gt;&gt;</div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="openerp.web.Query.first"><code>openerp.web.Query.first()</code></h6>
                    <p>Fetches the <strong>first</strong> result of the current
                        <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a>, or <code>null</code> if the current
                        <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> does have any result.</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Return type</div>
                            <div class="code-field-body">Deferred&lt;Object | null&gt;</div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="openerp.web.Query.count"><code>openerp.web.Query.count()</code></h6>
                    <p>Fetches the number of records the current
                        <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> would retrieve.</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Return type</div>
                            <div class="code-field-body">Deferred&lt;Number&gt;</div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="openerp.web.Query.group_by"><code>openerp.web.Query.group_by(<em>grouping...</em>)</code></h6>
                    <p>Fetches the groups for the query, using the first specified grouping parameter</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>grouping</strong> (<em>Array&lt;String&gt;</em>) -- Lists the levels of grouping asked of the server. Grouping can actually be an array or varargs.
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="code-field">
                            <div class="code-field-name">Return type</div>
                            <div class="code-field-body">Deferred&lt;Array&lt;openerp.web.QueryGroup&gt;&gt; | null</div>
                        </div>
                    </div>
                </section>
                <p>The second set of methods is the &quot;mutator&quot; methods, they create a
                    <strong>new</strong> <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> object with the relevant (internal) attribute either augmented or replaced.</p>
                <section
                    class="code-function">
                    <h6 id="openerp.web.Query.context"><code>openerp.web.Query.context(<em>ctx</em>)</code></h6>
                    <p>Adds the provided <code>ctx</code> to the query, on top of any existing context
                    </p>
            </section>
            <section class="code-function">
                <h6 id="openerp.web.Query.filter"><code>openerp.web.Query.filter(<em>domain</em>)</code></h6>
                <p>Adds the provided domain to the query, this domain is
                    <code>AND</code>-ed to the existing query domain.</p>
            </section>
            <section class="code-function">
                <h6 id="opeenrp.web.Query.offset"><code>opeenrp.web.Query.offset(<em>offset</em>)</code></h6>
                <p>Sets the provided offset on the query. The new offset
                    <em>replaces</em> the old one.</p>
            </section>
            <section class="code-function">
                <h6 id="openerp.web.Query.limit"><code>openerp.web.Query.limit(<em>limit</em>)</code></h6>
                <p>Sets the provided limit on the query. The new limit <em>replaces</em> the old one.</p>
            </section>
            <section class="code-function">
                <h6 id="openerp.web.Query.order_by"><code>openerp.web.Query.order_by(<em>fields…</em>)</code></h6>
                <p>Overrides the model's natural order with the provided field specifications. Behaves much like Django's <a href="https://django.readthedocs.org/en/latest/ref/models/querysets.html#django.db.models.query.QuerySet.order_by" class="external reference alert-link"
                        title="(in Django v1.11)"><code class="py py-meth xref">QuerySet.order_by</code></a>:</p>
                <ul>
                    <li>Takes 1..n field names, in order of most to least importance (the first field is the first sorting key). Fields are provided as strings.</li>
                    <li>A field specifies an ascending order, unless it is prefixed with the minus sign &quot;<code>-</code>&quot; in which case the field is used in the descending order</li>
                </ul>
                <p>Divergences from Django's sorting include a lack of random sort (
                    <code>?</code> field) and the inability to &quot;drill down&quot; into relations for sorting.</p>
            </section>
        </section>
        </section>
        <section id="aggregation-grouping">
            <h4>Aggregation (grouping)</h4>
            <p>Odoo has powerful grouping capacities, but they are kind-of strange in that they're recursive, and level n+1 relies on data provided directly by the grouping at level n. As a result, while
                <code class="py py-meth xref">openerp.models.Model.read_group()</code> works it's not a very intuitive API.
            </p>
            <p>Odoo Web eschews direct calls to <code class="py py-meth xref">read_group()</code> in favor of calling a method of <a href="#openerp.web.Query" class="internal reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a>,
                <a href="http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html#sqlalchemy.orm.query.Query.group_by" class="external reference" title="(in SQLAlchemy v0.9)"><code class="py py-meth xref">much
in the way it is one in SQLAlchemy</code></a>
                <a href="#terminal" class="footnote-ref" id="id2">2</a>:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="nx">some_query</span><span class="p">.</span><span class="nx">group_by</span><span class="p">([</span><span class="s1">&#39;field1&#39;</span><span class="p">,</span> <span class="s1">&#39;field2&#39;</span><span class="p">]).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">groups</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do things with the fetched groups</span>
<span class="p">});</span>
</pre></div>
            </div>
            <p>This method is asynchronous when provided with 1..n fields (to group on) as argument, but it can also be called without any field (empty fields collection or nothing at all). In this case, instead of returning a Deferred object it will return
                <code>null</code>.</p>
            <p>When grouping criterion come from a third-party and may or may not list fields (e.g. could be an empty list), this provides two ways to test the presence of actual subgroups (versus the need to perform a regular query for records):</p>
            <ul>
                <li>
                    <p>A check on <code>group_by</code>'s result and two completely separate code paths:
                    </p>
                    <div class="highlight-javascript">
                        <div class="highlight"><pre><span class="kd">var</span> <span class="nx">groups</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">groups</span> <span class="o">=</span> <span class="nx">some_query</span><span class="p">.</span><span class="nx">group_by</span><span class="p">(</span><span class="nx">gby</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">groups</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">gs</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// groups</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="c1">// no groups</span>
</pre></div>
                    </div>
                </li>
                <li>
                    <p>Or a more coherent code path using <a href="async.html#when" class="internal reference" title="when"><code class="js-func xref js">when()</code></a>'s ability to coerce values into deferreds:</p>
                    <div class="highlight-javascript">
                        <div class="highlight"><pre><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">some_query</span><span class="p">.</span><span class="nx">group_by</span><span class="p">(</span><span class="nx">gby</span><span class="p">)).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">groups</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">groups</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// No grouping</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// grouping, even if there are no groups (groups</span>
        <span class="c1">// itself could be an empty array)</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
                    </div>
                </li>
            </ul>
            <p>The result of a (successful) <a href="#openerp.web.Query.group_by" class="internal reference" title="openerp.web.Query.group_by"><code class="js-func xref js">group_by()</code></a> is an array of <a href="#openerp.web.QueryGroup" class="internal reference"
                    title="openerp.web.QueryGroup"><code class="js-class xref js">QueryGroup()</code></a>:</p>
            <section class="code-class">
                <h6 id="openerp.web.QueryGroup"><code><em >class </em>openerp.web.QueryGroup()</code></h6>
                <section class="code-function">
                    <h6 id="openerp.web.QueryGroup.get"><code>openerp.web.QueryGroup.get(<em>key</em>)</code></h6>
                    <p>returns the group's attribute <code>key</code>. Known attributes are:</p>
                    <dl><dt><code >grouped_on</code></dt>
                        <dd>which grouping field resulted from this group</dd><dt><code >value</code></dt>
                        <dd><code>grouped_on</code>'s value for this group</dd><dt><code >length</code></dt>
                        <dd>the number of records in the group</dd><dt><code >aggregates</code></dt>
                        <dd>a {field: value} mapping of aggregations for the group</dd>
                    </dl>
                </section>
                <section class="code-function">
                    <h6 id="openerp.web.QueryGroup.query"><code>openerp.web.QueryGroup.query([<em>fields...</em>])</code></h6>
                    <p>equivalent to <code class="js-func xref js">openerp.web.Model.query()</code> but pre-filtered to only include the records within this group. Returns a
                        <a href="#openerp.web.Query" class="internal alert-link reference" title="openerp.web.Query"><code class="js-class xref js">Query()</code></a> which can be further manipulated as usual.
                    </p>
                </section>
                <section class="code-function">
                    <h6 id="openerp.web.QueryGroup.subgroups"><code>openerp.web.QueryGroup.subgroups()</code></h6>
                    <p>returns a deferred to an array of <a href="#openerp.web.QueryGroup" class="internal alert-link reference" title="openerp.web.QueryGroup"><code class="js-class xref js">QueryGroup()</code></a> below this one</p>
                </section>
            </section>
        </section>
        <section id="low-level-api-rpc-calls-to-python-side">
            <h3>Low-level API: RPC calls to Python side</h3>
            <p>While the previous section is great for calling core OpenERP code (models code), it does not work if you want to call the Python side of Odoo Web.</p>
            <p>For this, a lower-level API exists on on
                <code class="js-class xref js">Session()</code> objects (usually available through
                <code>openerp.session</code>): the <code>rpc</code> method.</p>
            <p>This method simply takes an absolute path (the absolute URL of the JSON
                <a href="http.html#reference-http-routing" class="internal reference"><span >route</span></a> to call) and a mapping of attributes to values (passed as keyword arguments to the Python method). This function fetches the return value of
                the Python methods, converted to JSON.</p>
            <p>For instance, to call the <code>resequence</code> of the
                <code class="js-class xref js">DataSet()</code> controller:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">rpc</span><span class="p">(</span><span class="s1">&#39;/web/dataset/resequence&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">model</span><span class="o">:</span> <span class="nx">some_model</span><span class="p">,</span>
    <span class="nx">ids</span><span class="o">:</span> <span class="nx">array_of_ids</span><span class="p">,</span>
    <span class="nx">offset</span><span class="o">:</span> <span class="mi">42</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// resequence didn&#39;t error out</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// an error occured during during call</span>
<span class="p">});</span>
</pre></div>
            </div>
        </section>
        <section id="web-client"><i id="reference-javascript-client"></i>
            <h2>Web Client</h2></section>
        <section id="testing-in-odoo-web-client">
            <h2>Testing in Odoo Web Client</h2></section>
        <section id="javascript-unit-testing">
            <h3>Javascript Unit Testing</h3>
            <p>Odoo Web includes means to unit-test both the core code of Odoo Web and your own javascript modules. On the javascript side, unit-testing is based on <a href="http://qunitjs.com/" class="external reference">QUnit</a> with a number of helpers
                and extensions for better integration with Odoo.</p>
            <p>To see what the runner looks like, find (or start) an Odoo server with the web client enabled, and navigate to <code>/web/tests</code> This will show the runner selector, which lists all modules with javascript unit tests, and allows starting
                any of them (or all javascript tests in all modules at once).</p><img src="../_images/runner.png" class="img-responsive center-block">
            <p>Clicking any runner button will launch the corresponding tests in the bundled <a href="http://qunitjs.com/" class="external reference">QUnit</a> runner:</p><img src="../_images/tests.png" class="img-responsive center-block"></section>
        <section
            id="writing-a-test-case">
            <h3>Writing a test case</h3>
            <p>The first step is to list the test file(s). This is done through the
                <code>test</code> key of the Odoo manifest, by adding javascript files to it:</p>
            <div class="highlight-python">
                <div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Demonstration of web/javascript tests&quot;</span><span class="p">,</span>
    <span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="s">&#39;Hidden&#39;</span><span class="p">,</span>
    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;web&#39;</span><span class="p">],</span>
    <span class="s">&#39;test&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/test/demo.js&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
            </div>
            <p>and to create the corresponding test file(s)</p>
            <div role="alert" class="alert-info alert">
                <p class="alert-title">Note</p>
                <p>Test files which do not exist will be ignored, if all test files of a module are ignored (can not be found), the test runner will consider that the module has no javascript tests.</p>
            </div>
            <p>After that, refreshing the runner selector will display the new module and allow running all of its (0 so far) tests:</p><img src="../_images/runner2.png" class="img-responsive center-block">
            <p>The next step is to create a test case:</p>
            <div class="highlight-javascript">
                <div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">testing</span><span class="p">.</span><span class="nx">section</span><span class="p">(</span><span class="s1">&#39;basic section&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;my first test&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;this test has run&quot;</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
            </div>
            <p>All testing helpers and structures live in the <code>openerp.testing</code> module. Odoo tests live in a <a href="#openerp.testing.section" class="internal reference" title="openerp.testing.section"><code class="js-func xref js">section()</code></a>,
                which is itself part of a module. The first argument to a section is the name of the section, the second one is the section body.</p>
            <p><a href="#openerp.testing.case" class="internal reference" title="openerp.testing.case"><code class="js-func xref js">test</code></a>, provided by the
                <a href="#openerp.testing.section" class="internal reference" title="openerp.testing.section"><code class="js-func xref js">section()</code></a> to the callback, is used to register a given test case which will be run whenever the test
                runner actually does its job. Odoo Web test case use standard <a href="http://api.qunitjs.com/category/assert/" class="external reference">QUnit
assertions</a> within them.</p>
            <p>Launching the test runner at this point will run the test and display the corresponding assertion message, with red colors indicating the test failed:</p><img src="../_images/tests2.png" class="img-responsive center-block">
            <p>Fixing the test (by replacing <code>false</code> to <code>true</code> in the assertion) will make it pass:</p><img src="../_images/tests3.png" class="img-responsive center-block"></section>
            <section id="assertions">
                <h3>Assertions</h3>
                <p>As noted above, Odoo Web's tests use <a href="http://api.qunitjs.com/category/assert/" class="external reference">qunit assertions</a>. They are available globally (so they can just be called without references to anything). The following
                    list is available:</p>
                <section class="code-function">
                    <h6 id="ok"><code>ok(<em>state</em>[, <em>message</em>])</code></h6>
                    <p>checks that <code>state</code> is truthy (in the javascript sense)</p>
                </section>
                <section class="code-function">
                    <h6 id="strictEqual"><code>strictEqual(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>checks that the actual (produced by a method being tested) and expected values are identical (roughly equivalent to <code>ok(actual
=== expected, message)</code>)</p>
                </section>
                <section class="code-function">
                    <h6 id="notStrictEqual"><code>notStrictEqual(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>checks that the actual and expected values are <em>not</em> identical (roughly equivalent to <code>ok(actual !== expected, message)</code>)</p>
                </section>
                <section class="code-function">
                    <h6 id="deepEqual"><code>deepEqual(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>deep comparison between actual and expected: recurse into containers (objects and arrays) to ensure that they have the same keys/number of elements, and the values match.</p>
                </section>
                <section class="code-function">
                    <h6 id="notDeepEqual"><code>notDeepEqual(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>inverse operation to <a href="#deepEqual" class="internal alert-link reference" title="deepEqual"><code class="js-func xref js">deepEqual()</code></a></p>
                </section>
                <section class="code-function">
                    <h6 id="throws"><code>throws(<em>block[, expected][, message]</em>)</code></h6>
                    <p>checks that, when called, the <code>block</code> throws an error. Optionally validates that error against <code>expected</code>.</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>block</strong> (<em>Function</em>) -- </li>
                                    <li><strong>expected</strong> (<em>Error | RegExp</em>) -- if a regexp, checks that the thrown error's message matches the regular expression. If an error type, checks that the thrown error is of that type.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="equal"><code>equal(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>checks that <code>actual</code> and <code>expected</code> are loosely equal, using the <code>==</code> operator and its coercion rules.</p>
                </section>
                <section class="code-function">
                    <h6 id="notEqual"><code>notEqual(<em>actual</em>, <em>expected</em>[, <em>message</em>])</code></h6>
                    <p>inverse operation to <a href="#equal" class="internal alert-link reference" title="equal"><code class="js-func xref js">equal()</code></a></p>
                </section>
            </section>
            <section id="getting-an-odoo-instance">
                <h3>Getting an Odoo instance</h3>
                <p>The Odoo instance is the base through which most Odoo Web modules behaviors (functions, objects, …) are accessed. As a result, the test framework automatically builds one, and loads the module being tested and all of its dependencies inside
                    it. This new instance is provided as the first positional parameter to your test cases. Let's observe by adding javascript code (not test code) to the test module:</p>
                <div class="highlight-python">
                    <div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Demonstration of web/javascript tests&quot;</span><span class="p">,</span>
    <span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="s">&#39;Hidden&#39;</span><span class="p">,</span>
    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;web&#39;</span><span class="p">],</span>
    <span class="s">&#39;js&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/src/js/demo.js&#39;</span><span class="p">],</span>
    <span class="s">&#39;test&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/test/demo.js&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
                </div>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="c1">// src/js/demo.js</span>
<span class="nx">openerp</span><span class="p">.</span><span class="nx">web_tests_demo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web_tests_demo</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">value_true</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">SomeType</span><span class="o">:</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
            <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">};</span>
<span class="p">};</span>
</pre></div>
                </div>
                <p>and then adding a new test case, which simply checks that the
                    <code>instance</code> contains all the expected stuff we created in the module:
                </p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="c1">// test/demo.js</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;module content&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ok</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">web_tests_demo</span><span class="p">.</span><span class="nx">value_true</span><span class="p">,</span> <span class="s2">&quot;should have a true value&quot;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">type_instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web_tests_demo</span><span class="p">.</span><span class="nx">SomeType</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
    <span class="nx">strictEqual</span><span class="p">(</span><span class="nx">type_instance</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;should have provided value&quot;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
                </div>
            </section>
            <section id="dom-scratchpad">
                <h3>DOM Scratchpad</h3>
                <p>As in the wider client, arbitrarily accessing document content is strongly discouraged during tests. But DOM access is still needed to e.g. fully initialize <code class="js-class xref js">widgets</code> before testing them.</p>
                <p>Thus, a test case gets a DOM scratchpad as its second positional parameter, in a jQuery instance. That scratchpad is fully cleaned up before each test, and as long as it doesn't do anything outside the scratchpad your code can do whatever
                    it wants:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="c1">// test/demo.js</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;DOM content&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">$scratchpad</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scratchpad</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;span class=&quot;foo bar&quot;&gt;ok&lt;/span&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
    <span class="nx">ok</span><span class="p">(</span><span class="nx">$scratchpad</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">),</span>
       <span class="s2">&quot;should have provided class&quot;</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;clean scratchpad&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">$scratchpad</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ok</span><span class="p">(</span><span class="o">!</span><span class="nx">$scratchpad</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">length</span><span class="p">,</span> <span class="s2">&quot;should have no content&quot;</span><span class="p">);</span>
    <span class="nx">ok</span><span class="p">(</span><span class="o">!</span><span class="nx">$scratchpad</span><span class="p">.</span><span class="nx">text</span><span class="p">(),</span> <span class="s2">&quot;should have no text&quot;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
                </div>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>The top-level element of the scratchpad is not cleaned up, test cases can add text or DOM children but shoud not alter
                        <code>$scratchpad</code> itself.</p>
                </div>
            </section>
            <section id="loading-templates">
                <h3>Loading templates</h3>
                <p>To avoid the corresponding processing costs, by default templates are not loaded into QWeb. If you need to render e.g. widgets making use of QWeb templates, you can request their loading through the
                    <a href="#TestOptions.templates" class="internal reference" title="TestOptions.templates"><code class="js-attr xref js">templates</code></a> option to the
                    <a href="#openerp.testing.case" class="internal reference" title="openerp.testing.case"><code class="js-func xref js">test case
function</code></a>.</p>
                <p>This will automatically load all relevant templates in the instance's qweb before running the test case:</p>
                <div class="highlight-python">
                    <div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Demonstration of web/javascript tests&quot;</span><span class="p">,</span>
    <span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="s">&#39;Hidden&#39;</span><span class="p">,</span>
    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;web&#39;</span><span class="p">],</span>
    <span class="s">&#39;js&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/src/js/demo.js&#39;</span><span class="p">],</span>
    <span class="s">&#39;test&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/test/demo.js&#39;</span><span class="p">],</span>
    <span class="s">&#39;qweb&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;static/src/xml/demo.xml&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
                </div>
                <div class="highlight-xml">
                    <div class="highlight"><pre><span class="c">&lt;!-- src/xml/demo.xml --&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">id=</span><span class="s">&quot;template&quot;</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;DemoTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;5&quot;</span> <span class="na">t-as=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;value&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
                </div>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="c1">// test/demo.js</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;templates&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">templates</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;DemoTemplate&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">texts</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">s</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">text</span><span class="p">();</span>
    <span class="p">}).</span><span class="nx">get</span><span class="p">();</span>

    <span class="nx">deepEqual</span><span class="p">(</span><span class="nx">texts</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]);</span>
<span class="p">});</span>
</pre></div>
                </div>
            </section>
            <section id="asynchronous-cases">
                <h3>Asynchronous cases</h3>
                <p>The test case examples so far are all synchronous, they execute from the first to the last line and once the last line has executed the test is done. But the web client is full of <a href="async.html#reference-async" class="internal reference"><span >asynchronous code</span></a>,
                    and thus test cases need to be async-aware.</p>
                <p>This is done by returning a <a href="async.html#Deferred" class="internal reference" title="Deferred"><code class="js-class xref js">deferred</code></a> from the case callback:</p>
                <div class="highlight-javascript">
                    <div class="highlight"><pre><span class="c1">// test/demo.js</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;asynchronous&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">asserts</span><span class="o">:</span> <span class="mi">1</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">d</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
                </div>
                <p>This example also uses the <a href="#TestOptions" class="internal reference" title="TestOptions"><code class="js-class xref js">options parameter</code></a> to specify the number of assertions the case should expect, if less or more assertions
                    are specified the case will count as failed.</p>
                <p>Asynchronous test cases <em>must</em> specify the number of assertions they will run. This allows more easily catching situations where e.g. the test architecture was not warned about asynchronous operations.</p>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>Asynchronous test cases also have a 2 seconds timeout: if the test does not finish within 2 seconds, it will be considered failed. This pretty much always means the test will not resolve. This timeout <em>only</em> applies to the test
                        itself, not to the setup and teardown processes.</p>
                </div>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>If the returned deferred is rejected, the test will be failed unless <a href="#TestOptions.fail_on_rejection" class="internal alert-link reference" title="TestOptions.fail_on_rejection"><code class="js-attr xref js">fail_on_rejection</code></a>                        is set to
                        <code>false</code>.</p>
                </div>
            </section>
            <section id="id3">
                <h3>RPC</h3>
                <p>An important subset of asynchronous test cases is test cases which need to perform (and chain, to an extent) RPC calls.</p>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>Because they are a subset of asynchronous cases, RPC cases must also provide a valid <a href="#TestOptions.asserts" class="internal alert-link reference" title="TestOptions.asserts"><code class="js-attr xref js">assertions count</code></a>.</p>
                </div>
                <p>To enable mock RPC, set the <a href="#TestOptions.rpc" class="internal reference" title="TestOptions.rpc"><code class="js-attr xref js">rpc option</code></a> to
                    <code>mock</code>. This will add a third parameter to the test case callback:</p>
                <section class="code-function">
                    <h6 id="mock"><code>mock(<em>rpc_spec</em>, <em>handler</em>)</code></h6>
                    <p>Can be used in two different ways depending on the shape of the first parameter:</p>
                    <ul>
                        <li>
                            <p>If it matches the pattern <code>model:method</code> (if it contains a colon, essentially) the call will set up the mocking of an RPC call straight to the Odoo server (through XMLRPC) as performed via e.g. <code class="js-func xref js">openerp.web.Model.call()</code>.</p>
                            <p>In that case, <code>handler</code> should be a function taking two arguments <code>args</code> and <code>kwargs</code>, matching the corresponding arguments on the server side and should simply return the value as if it were
                                returned by the Python XMLRPC handler:</p>
                            <div class="highlight-javascript">
                                <div class="highlight"><pre><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;XML-RPC&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">rpc</span><span class="o">:</span> <span class="s1">&#39;mock&#39;</span><span class="p">,</span> <span class="nx">asserts</span><span class="o">:</span> <span class="mi">3</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">$s</span><span class="p">,</span> <span class="nx">mock</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// set up mocking</span>
    <span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;people.famous:name_search&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="nx">kwargs</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">strictEqual</span><span class="p">(</span><span class="nx">kwargs</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;bob&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Microsoft Bob&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Bob the Builder&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Silent Bob&quot;</span><span class="p">]</span>
        <span class="p">];</span>
    <span class="p">});</span>

    <span class="c1">// actual test code</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;people.famous&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;name_search&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;bob&#39;</span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;shoud return 3 people&quot;</span><span class="p">);</span>
            <span class="nx">strictEqual</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Microsoft Bob&quot;</span><span class="p">,</span>
                <span class="s2">&quot;the most famous bob should be Microsoft Bob&quot;</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">});</span>
</pre></div>
                            </div>
                        </li>
                        <li>
                            <p>Otherwise, if it matches an absolute path (e.g. <code>/a/b/c</code>) it will mock a JSON-RPC call to a web client controller, such as
                                <code>/web/webclient/translations</code>. In that case, the handler takes a single <code>params</code> argument holding all of the parameters provided over JSON-RPC.</p>
                            <p>As previously, the handler should simply return the result value as if returned by the original JSON-RPC handler:</p>
                            <div class="highlight-javascript">
                                <div class="highlight"><pre><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;JSON-RPC&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">rpc</span><span class="o">:</span> <span class="s1">&#39;mock&#39;</span><span class="p">,</span> <span class="nx">asserts</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">templates</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">$s</span><span class="p">,</span> <span class="nx">mock</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">fetched_dbs</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">fetched_langs</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;/web/database/get_list&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">fetched_dbs</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">];</span>
    <span class="p">});</span>
    <span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;/web/session/get_lang_list&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">fetched_langs</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">[[</span><span class="s1">&#39;vo_IS&#39;</span><span class="p">,</span> <span class="s1">&#39;Hopelandic / Vonlenska&#39;</span><span class="p">]];</span>
    <span class="p">});</span>

    <span class="c1">// widget needs that or it blows up</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">webclient</span> <span class="o">=</span> <span class="p">{</span><span class="nx">toggle_bars</span><span class="o">:</span> <span class="nx">openerp</span><span class="p">.</span><span class="nx">testing</span><span class="p">.</span><span class="nx">noop</span><span class="p">};</span>
    <span class="kd">var</span> <span class="nx">dbm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">DatabaseManager</span><span class="p">({});</span>
    <span class="k">return</span> <span class="nx">dbm</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$s</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="p">(</span><span class="nx">fetched_dbs</span><span class="p">,</span> <span class="s2">&quot;should have fetched databases&quot;</span><span class="p">);</span>
        <span class="nx">ok</span><span class="p">(</span><span class="nx">fetched_langs</span><span class="p">,</span> <span class="s2">&quot;should have fetched languages&quot;</span><span class="p">);</span>
        <span class="nx">deepEqual</span><span class="p">(</span><span class="nx">dbm</span><span class="p">.</span><span class="nx">db_list</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">]);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
                            </div>
                        </li>
                    </ul>
                </section>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>Mock handlers can contain assertions, these assertions should be part of the assertions count (and if multiple calls are made to a handler containing assertions, it multiplies the effective number of assertions).</p>
                </div>
            </section>
            <section id="testing-api">
                <h3>Testing API</h3>
                <section class="code-function">
                    <h6 id="openerp.testing.section"><code>openerp.testing.section(<em>name</em>, [<em>options</em>, ]<em>body</em>)</code></h6>
                    <p>A test section, serves as shared namespace for related tests (for constants or values to only set up once). The <code>body</code> function should contain the tests themselves.</p>
                    <p>Note that the order in which tests are run is essentially undefined, do <em>not</em> rely on it.</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>name</strong> (<em>String</em>) -- </li>
                                    <li><strong>options</strong> (<a href="#TestOptions" class="internal alert-link reference" title="TestOptions"><em >TestOptions</em></a>) -- </li>
                                    <li><strong>body</strong> (Function&lt;<a href="#openerp.testing.case" class="internal alert-link reference" title="openerp.testing.case"><code class="js-func xref js">case()</code></a>, void&gt;) -- </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="code-function">
                    <h6 id="openerp.testing.case"><code>openerp.testing.case(<em>name</em>, [<em>options</em>, ]<em>callback</em>)</code></h6>
                    <p>Registers a test case callback in the test runner, the callback will only be run once the runner is started (or maybe not at all, if the test is filtered out).</p>
                    <div class="code-fields">
                        <div class="code-field">
                            <div class="code-field-name">Arguments</div>
                            <div class="code-field-body">
                                <ul>
                                    <li><strong>name</strong> (<em>String</em>) -- </li>
                                    <li><strong>options</strong> (<a href="#TestOptions" class="internal alert-link reference" title="TestOptions"><em >TestOptions</em></a>) -- </li>
                                    <li><strong>callback</strong> (<em>Function&lt;instance, $, Function&lt;String, Function, void&gt;&gt;</em>) -- </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="code-class">
                    <h6 id="TestOptions"><code><em >class </em>TestOptions()</code></h6>
                    <p>the various options which can be passed to
                        <a href="#openerp.testing.section" class="internal alert-link reference" title="openerp.testing.section"><code class="js-func xref js">section()</code></a> or
                        <a href="#openerp.testing.case" class="internal alert-link reference" title="openerp.testing.case"><code class="js-func xref js">case()</code></a>. Except for
                        <a href="#TestOptions.setup" class="internal alert-link reference" title="TestOptions.setup"><code class="js-attr xref js">setup</code></a> and
                        <a href="#TestOptions.teardown" class="internal alert-link reference" title="TestOptions.teardown"><code class="js-attr xref js">teardown</code></a>, an option on
                        <a href="#openerp.testing.case" class="internal alert-link reference" title="openerp.testing.case"><code class="js-func xref js">case()</code></a> will overwrite the corresponding option on <a href="#openerp.testing.section" class="internal alert-link reference"
                            title="openerp.testing.section"><code class="js-func xref js">section()</code></a> so e.g. <a href="#TestOptions.rpc" class="internal alert-link reference" title="TestOptions.rpc"><code class="js-attr xref js">rpc</code></a> can
                        be set for a
                        <a href="#openerp.testing.section" class="internal alert-link reference" title="openerp.testing.section"><code class="js-func xref js">section()</code></a> and then differently set for some <a href="#openerp.testing.case" class="internal alert-link reference"
                            title="openerp.testing.case"><code class="js-func xref js">case()</code></a> of that
                        <a href="#openerp.testing.section" class="internal alert-link reference" title="openerp.testing.section"><code class="js-func xref js">section()</code></a></p>
                    <section class="code-attribute">
                        <h6 id="TestOptions.asserts"><code>TestOptions.asserts</code></h6>
                        <p>An integer, the number of assertions which should run during a normal execution of the test. Mandatory for asynchronous tests.</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="TestOptions.setup"><code>TestOptions.setup</code></h6>
                        <p>Test case setup, run right before each test case. A section's
                            <a href="#TestOptions.setup" class="internal alert-link reference" title="TestOptions.setup"><code class="js-func xref js">setup()</code></a> is run before the case's own, if both are specified.</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="TestOptions.teardown"><code>TestOptions.teardown</code></h6>
                        <p>Test case teardown, a case's <a href="#TestOptions.teardown" class="internal alert-link reference" title="TestOptions.teardown"><code class="js-func xref js">teardown()</code></a> is run before the corresponding section if both
                            are present.</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="TestOptions.fail_on_rejection"><code>TestOptions.fail_on_rejection</code></h6>
                        <p>If the test is asynchronous and its resulting promise is rejected, fail the test. Defaults to <code>true</code>, set to
                            <code>false</code> to not fail the test in case of rejection:</p>
                        <div class="highlight-javascript">
                            <div class="highlight"><pre><span class="c1">// test/demo.js</span>
<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;unfail rejection&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">asserts</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">fail_on_rejection</span><span class="o">:</span> <span class="kc">false</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">d</span><span class="p">.</span><span class="nx">reject</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
                        </div>
                    </section>
                    <section class="code-attribute">
                        <h6 id="TestOptions.rpc"><code>TestOptions.rpc</code></h6>
                        <p>RPC method to use during tests, one of <code>&quot;mock&quot;</code> or
                            <code>&quot;rpc&quot;</code>. Any other value will disable RPC for the test (if they were enabled by the suite for instance).</p>
                    </section>
                    <section class="code-attribute">
                        <h6 id="TestOptions.templates"><code>TestOptions.templates</code></h6>
                        <p>Whether the current module (and its dependencies)'s templates should be loaded into QWeb before starting the test. A boolean, <code>false</code> by default.</p>
                    </section>
                </section>
                <p>The test runner can also use two global configuration values set directly on the <code>window</code> object:</p>
                <ul>
                    <li><code>oe_all_dependencies</code> is an <code>Array</code> of all modules with a web component, ordered by dependency (for a module <code>A</code> with dependencies <code>A'</code>, any module of <code>A'</code> must come before <code>A</code>                        in the array)</li>
                </ul>
            </section>
            <section id="running-through-python">
                <h3>Running through Python</h3>
                <p>The web client includes the means to run these tests on the command-line (or in a CI system), but while actually running it is pretty simple the setup of the pre-requisite parts has some complexities.
                </p>
                <ol>
                    <li>Install <a href="http://pypi.python.org/pypi/unittest2" class="external reference">unittest2</a> in your Python environment. Both can trivially be installed via <a href="http://pip-installer.org" class="external reference">pip</a>                        or
                        <a href="http://packages.python.org/distribute/easy_install.html" class="external reference">easy_install</a>.</li>
                    <li>
                        <p>Install <a href="http://phantomjs.org/" class="external reference">PhantomJS</a>. It is a headless browser which allows automating running and testing web pages. <a href="http://pypi.python.org/pypi/QUnitSuite/" class="external reference">QUnitSuite</a>                            uses it to actually run the <a href="http://qunitjs.com/" class="external reference">qunit</a> test suite.</p>
                        <p>The <a href="http://phantomjs.org/" class="external reference">PhantomJS</a> website provides pre-built binaries for some platforms, and your OS's package management probably provides it as well.
                        </p>
                        <p>If you're building <a href="http://phantomjs.org/" class="external reference">PhantomJS</a> from source, I recommend preparing for some knitting time as it's not exactly fast (it needs to compile both <a href="http://qt-project.org/"
                                class="external reference">Qt</a> and <a href="http://www.webkit.org/" class="external reference">Webkit</a>, both being pretty big projects).</p>
                        <div role="alert" class="alert-info alert">
                            <p class="alert-title">Note</p>
                            <p>Because <a href="http://phantomjs.org/" class="external reference alert-link">PhantomJS</a> is webkit-based, it will not be able to test if Firefox, Opera or Internet Explorer can correctly run the test suite (and it is only
                                an approximation for Safari and Chrome). It is therefore recommended to <em>also</em> run the test suites in actual browsers once in a while.</p>
                        </div>
                        <div role="alert" class="alert-info alert">
                            <p class="alert-title">Note</p>
                            <p>The version of <a href="http://phantomjs.org/" class="external reference alert-link">PhantomJS</a> this was build through is 1.7, previous versions <em>should</em> work but are not actually supported (and tend to just segfault
                                when something goes wrong in
                                <a href="http://phantomjs.org/" class="external reference alert-link">PhantomJS</a> itself so they're a pain to debug).</p>
                        </div>
                    </li>
                    <li>
                        <p>Install a new database with all relevant modules (all modules with a web component at least), then restart the server</p>
                        <div role="alert" class="alert-info alert">
                            <p class="alert-title">Note</p>
                            <p>For some tests, a source database needs to be duplicated. This operation requires that there be no connection to the database being duplicated, but Odoo doesn't currently break existing/outstanding connections, so restarting
                                the server is the simplest way to ensure everything is in the right state.</p>
                        </div>
                    </li>
                    <li>
                        <p>Launch <code>oe run-tests -d $DATABASE -mweb</code> with the correct addons-path specified (and replacing <code>$DATABASE</code> by the source database you created above)</p>
                        <div role="alert" class="alert-info alert">
                            <p class="alert-title">Note</p>
                            <p>If you leave out <code>-mweb</code>, the runner will attempt to run all the tests in all the modules, which may or may not work.</p>
                        </div>
                    </li>
                </ol>
                <p>If everything went correctly, you should now see a list of tests with (hopefully) <code>ok</code> next to their names, closing with a report of the number of tests run and the time it took:</p>
                <div class="highlight-text">
                    <div class="highlight"><pre>test_empty_find (openerp.addons.web.tests.test_dataset.TestDataSetController) ... ok
test_ids_shortcut (openerp.addons.web.tests.test_dataset.TestDataSetController) ... ok
test_regular_find (openerp.addons.web.tests.test_dataset.TestDataSetController) ... ok
web.testing.stack: direct, value, success ... ok
web.testing.stack: direct, deferred, success ... ok
web.testing.stack: direct, value, error ... ok
web.testing.stack: direct, deferred, failure ... ok
web.testing.stack: successful setup ... ok
web.testing.stack: successful teardown ... ok
web.testing.stack: successful setup and teardown ... ok

[snip ~150 lines]

test_convert_complex_context (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok
test_convert_complex_domain (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok
test_convert_literal_context (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok
test_convert_literal_domain (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok
test_retrieve_nonliteral_context (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok
test_retrieve_nonliteral_domain (openerp.addons.web.tests.test_view.DomainsAndContextsTest) ... ok

----------------------------------------------------------------------
Ran 181 tests in 15.706s

OK
</pre></div>
                </div>
                <p>Congratulation, you have just performed a successful &quot;offline&quot; run of the OpenERP Web test suite.</p>
                <div role="alert" class="alert-info alert">
                    <p class="alert-title">Note</p>
                    <p>Note that this runs all the Python tests for the <code>web</code> module, but all the web tests for all of Odoo. This can be surprising.</p>
                </div>
                <div class="footnote" id="eventsdelegation"><span class="footnote-label"><a class="footnote-backref" href="#id1">[1]</a></span> not all DOM events are compatible with events delegation</div>
                <div class="footnote" id="terminal"><span class="footnote-label"><a class="footnote-backref" href="#id2">[2]</a></span> with a small twist:
                    <a href="http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html#sqlalchemy.orm.query.Query.group_by" class="external reference" title="(in SQLAlchemy v0.9)"><code class="py py-meth xref">sqlalchemy.orm.query.Query.group_by()</code></a> is not terminal, it returns a query which can still be altered.</div>
            </section>

            </article>
            </div>

            <div id="mask"></div>
    </main>

    <div class="floating_action_container">
        <a id="floating_action" class="ripple" href="#">
            <i class="mdi-action-explore"></i>
        </a>
        <div id="floating_action_menu">
            <span class="bubble"></span>
            <ul class="list-group content">
                <li class="list-group-item ripple"><a>Cras justo odio</a></li>
                <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
                <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
                <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
                <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
            </ul>
        </div>
    </div>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter42690849 = new Ya.Metrika({
                    id: 42690849,
                    clickmap: true,
                    trackLinks: true,
                    accurateTrackBounce: true,
                    webvisor: true,
                    trackHash: true
                });
            } catch (e) {}
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function() {
                n.parentNode.insertBefore(s, n);
            };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else {
            f();
        }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/42690849" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</body>

</html>
